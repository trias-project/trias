<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply GAM to time series and assess emerging status — apply_gam • trias</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply GAM to time series and assess emerging status — apply_gam"><meta name="description" content="This function applies generalized additive models (GAM) to assess emerging
status for a certain time window."><meta property="og:description" content="This function applies generalized additive models (GAM) to assess emerging
status for a certain time window."><meta property="og:image" content="https://trias-project.github.io/trias/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/trias-project/trias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Apply GAM to time series and assess emerging status</h1>
      <small class="dont-index">Source: <a href="https://github.com/trias-project/trias/blob/main/R/apply_gam.R" class="external-link"><code>R/apply_gam.R</code></a></small>
      <div class="d-none name"><code>apply_gam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function applies generalized additive models (GAM) to assess emerging
status for a certain time window.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">apply_gam</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">y_var</span>,</span>
<span>  <span class="va">eval_years</span>,</span>
<span>  year <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  taxonKey <span class="op">=</span> <span class="st">"taxonKey"</span>,</span>
<span>  type_indicator <span class="op">=</span> <span class="st">"observations"</span>,</span>
<span>  baseline_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p_max <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  taxon_key <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  df_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_label <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  y_label <span class="op">=</span> <span class="st">"Observations"</span>,</span>
<span>  saveplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dir_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>df. A dataframe containing temporal data.</p></dd>


<dt id="arg-y-var">y_var<a class="anchor" aria-label="anchor" href="#arg-y-var"></a></dt>
<dd><p>character. Name of column containing variable to model. It has
to be passed as string, e.g. <code>"occurrences"</code>.</p></dd>


<dt id="arg-eval-years">eval_years<a class="anchor" aria-label="anchor" href="#arg-eval-years"></a></dt>
<dd><p>numeric. Temporal value(s) when emerging status has to be
evaluated.</p></dd>


<dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>character. Name of column containing temporal values. It has to
be passed as string, e.g. <code>"time"</code>. Default: <code>"year"</code>.</p></dd>


<dt id="arg-taxonkey">taxonKey<a class="anchor" aria-label="anchor" href="#arg-taxonkey"></a></dt>
<dd><p>character. Name of column containing taxon IDs. It has to be
passed as string, e.g. <code>"taxon"</code>. Default: <code>"taxonKey"</code>.</p></dd>


<dt id="arg-type-indicator">type_indicator<a class="anchor" aria-label="anchor" href="#arg-type-indicator"></a></dt>
<dd><p>character. One of <code>"observations"</code>, <code>"occupancy"</code>. Used
in title of the output plot. Default: <code>"observations"</code>.</p></dd>


<dt id="arg-baseline-var">baseline_var<a class="anchor" aria-label="anchor" href="#arg-baseline-var"></a></dt>
<dd><p>character. Name of the column containing values to use as
additional covariate. Such covariate is introduced in the model to correct
research effort bias. Default: <code>NULL</code>. If <code>NULL</code> internal variable
<code>method_em = "basic"</code>, otherwise <code>method_em = "correct_baseline"</code>. Value of
<code>method_em</code> will be part of title of output plot.</p></dd>


<dt id="arg-p-max">p_max<a class="anchor" aria-label="anchor" href="#arg-p-max"></a></dt>
<dd><p>numeric. A value between 0 and 1. Default: 0.1.</p></dd>


<dt id="arg-taxon-key">taxon_key<a class="anchor" aria-label="anchor" href="#arg-taxon-key"></a></dt>
<dd><p>numeric, character. Taxon key the timeseries belongs to.
Used exclusively in graph title and filename (if <code>saveplot = TRUE</code>).
Default: <code>NULL</code>.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>character. Species name the timeseries belongs to. Used
exclusively in graph title and filename (if <code>saveplot = TRUE</code>). Default:
<code>NULL</code>.</p></dd>


<dt id="arg-df-title">df_title<a class="anchor" aria-label="anchor" href="#arg-df-title"></a></dt>
<dd><p>character. Any string you would like to add to graph titles
and filenames (if <code>saveplot = TRUE</code>). The title is always composed of:
<code>"GAM"</code> + <code>type_indicator</code> + <code>method_em</code> + <code>taxon_key</code> + <code>name</code> +
<code>df_title</code> separated by underscore ("_"). Default: <code>NULL</code>.</p></dd>


<dt id="arg-x-label">x_label<a class="anchor" aria-label="anchor" href="#arg-x-label"></a></dt>
<dd><p>character. x-axis label of output plot. Default: <code>"year"</code>.</p></dd>


<dt id="arg-y-label">y_label<a class="anchor" aria-label="anchor" href="#arg-y-label"></a></dt>
<dd><p>character. y-axis label of output plot. Default: <code>"number of observations"</code>.</p></dd>


<dt id="arg-saveplot">saveplot<a class="anchor" aria-label="anchor" href="#arg-saveplot"></a></dt>
<dd><p>logical. If <code>TRUE</code> the plots are automatically saved.
Default: <code>FALSE</code>.</p></dd>


<dt id="arg-dir-name">dir_name<a class="anchor" aria-label="anchor" href="#arg-dir-name"></a></dt>
<dd><p>character. Path of directory where saving plots. If path
doesn't exists, directory will be created. Example: "./output/graphs/". If
<code>NULL</code> and <code>saveplot</code> is <code>TRUE</code>, plots are saved in current directory.
Default: <code>NULL</code>.</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>numeric. Plot width in pixels. Values are passed to
<a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a>. Ignored if <code>saveplot</code> = <code>FALSE</code>. If <code>NULL</code> and
<code>saveplot</code> is <code>TRUE</code>, <code>width</code> is set to 1680 and a message is returned.
Default: <code>NULL</code>.</p></dd>


<dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p>numeric. Plot height in pixels. Values are passed to
<a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a>. Ignored if <code>saveplot</code> = <code>FALSE</code>. If <code>NULL</code> and
<code>saveplot</code> is <code>TRUE</code>, <code>height</code> to 1200 and a message is returned. Default:
<code>NULL</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical. If <code>TRUE</code> status of processing and possible issues
are returned. Default: <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>list with six slots:</p><ol><li><p><code>em_summary</code>: df. A data.frame summarizing the emerging status
outputs. <code>em_summary</code> contains as many rows as the length of input variable
<code>eval_year</code>. So, if you evaluate GAM on three years, <code>em_summary</code> will
contain three rows. It contains the following columns:</p><ul><li><p><code>"taxonKey"</code>: column containing taxon ID. Column name equal to value of
argument <code>taxonKey</code>.</p></li>
<li><p><code>"year"</code>: column containing temporal values. Column name equal
to value of argument <code>year</code>. Column itself is equal to value of
argument <code>eval_years</code>. So, if you evaluate GAM on years 2017, 2018
(<code>eval_years = c(2017, 2018)</code>), you will get these two values in this
column.</p></li>
<li><p><code>em_status</code>: numeric. Emerging statuses, an integer
between 0 and 3.</p></li>
<li><p><code>growth</code>: numeric. Lower limit of GAM confidence interval for the first
derivative, if positive. It represents the lower guaranteed growth.</p></li>
<li><p><code>method</code>: character. GAM method, One of: <code>"correct_baseline"</code> and
<code>"basic"</code>. See details above in description of argument <code>use_baseline</code>.</p></li>
</ul></li>
<li><p><code>model</code>: gam object. The model as returned by <code>gam()</code> function.
<code>NULL</code> if GAM cannot be applied.</p></li>
<li><p><code>output</code>: df. Complete data.frame containing more details than the
summary <code>em_summary</code>. It contains the following columns:</p><ul><li><p>all columns in <code>df</code>.</p></li>
<li><p><code>method</code>: character. GAM method, One of: <code>"correct_baseline"</code> and
<code>"basic"</code>. See details above in description of argument <code>use_baseline</code>.</p></li>
<li><p><code>fit</code>: numeric. Fit values.</p></li>
<li><p><code>ucl</code>: numeric. The upper confidence level values.</p></li>
<li><p><code>lcl</code>: numeric. The lower confidence level values.</p></li>
<li><p><code>em1</code>: numeric. The emergency value for the 1st derivative. -1, 0 or +1.</p></li>
<li><p><code>em2</code>: numeric. The emergency value for the 2nd derivative: -1, 0 or +1.</p></li>
<li><p><code>em</code>: numeric. The emergency value: from -4 to +4, based on <code>em1</code> and
<code>em2</code>. See Details.</p></li>
<li><p><code>em_status</code>: numeric. Emerging statuses, an integer
between 0 and 3. See Details.</p></li>
<li><p><code>growth</code>: numeric. Lower limit of GAM confidence interval for the first
derivative, if positive. It represents the lower guaranteed growth.</p></li>
</ul></li>
<li><p><code>first_derivative</code>: df. Data.frame with details of first derivatives.
It contains the following columns:</p><ul><li><p><code>smooth</code>: smooth identifier. Example: <code>s(year)</code>.</p></li>
<li><p><code>derivative</code>: numeric. Value of first derivative.</p></li>
<li><p><code>se</code>: numeric. Standard error of <code>derivative</code>.</p></li>
<li><p><code>crit</code>: numeric. Critical value required such that
<code>derivative + (se * crit)</code> and <code>derivative - (se * crit)</code> form
the upper and lower bounds of the confidence interval on the first
derivative of the estimated smooth at the specific confidence level. In our
case the confidence level is hard-coded: 0.8.
Then <code>crit &lt;- qnorm(p = (1-0.8)/2, mean = 0, sd = 1, lower.tail = FALSE)</code>.</p></li>
<li><p><code>lower_ci</code>: numeric. Lower bound of the confidence interval of the
estimated smooth.</p></li>
<li><p><code>upper_ci</code>: numeric. Upper bound of the
confidence interval of the estimated smooth.</p></li>
<li><p>value of argument <code>year</code>: column with temporal values.</p></li>
<li><p>value of argument <code>baseline_var</code>: column with the fitted values for the
baseline. If <code>baseline_var</code> is <code>NULL</code>, this column is not present.</p></li>
</ul></li>
<li><p><code>second_derivative</code>: df. Data.frame with details of second
derivatives. Same columns as <code>first_derivatives</code>.</p></li>
<li><p><code>plot</code>: a ggplot2 object. Plot of observations with GAM output and
emerging status. If emerging status cannot be assessed only observations are
plotted.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The GAM modelling is performed using the <code>mgcvb::gam()</code>. To use this
function, we pass:</p><ul><li><p>a formula</p></li>
<li><p>a family object specifying the distribution</p></li>
<li><p>a smoothing parameter estimation method</p>
<p>For more information about all other arguments, see <code>[mgcv::gam()]</code>.</p>
<p>If no covariate is used (<code>baseline_var</code> = NULL), the GAM formula is: <code>n ~ s(year, k = maxk, m = 3, bs = "tp")</code>. Otherwise the GAM formula has a
second term, <code>s(n_covariate)</code> and so the GAM formula is <code>n ~ s(year, k = maxk, m = 3, bs = "tp") + s(n_covariate)</code>.</p>
<p>Description of the parameters present in the formula above:</p></li>
<li><p><code>k</code>: dimension of the basis used to represent the smooth term, i.e. the
number of <em>knots</em> used for calculating the smoother. We #' set <code>k</code> to
<code>maxk</code>, which is the number of decades in the time series. If less than 5
decades are present in the data, <code>maxk</code> is #' set to 5.</p></li>
<li><p><code>bs</code> indicates the basis to use for the smoothing: we uses the default
penalized thin plate regression splines.</p></li>
<li><p><code>m</code> specifies the order of the derivatives in the thin plate spline
penalty. We use <code>m = 3</code>, the default value.</p>
<p>We use <code>[mgcv::nb()]</code>, a negative binomial family to perform the GAM.</p>
<p>The smoothing parameter estimation method is set to REML (Restricted
maximum likelihood approach). If the P-value of the GAM smoother(s) is/are
above threshold value <code>p_max</code>, GAM is not performed and the next warning is
returned: "GAM output cannot be used: p-values of all GAM smoothers are
above {p_max}" where <code>p_max</code> is the P-value used as threshold as defined
by argument <code>p_max</code>.</p>
<p>If the <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">mgcv::gam()</a></code> returns an error or a warning, the following message
is returned to the user: "GAM ({method_em}) cannot be performed or cannot
converge.", where <code>method_em</code> is one of <code>"basic"</code> or <code>"correct_baseline"</code>.
See argument <code>baseline_var</code>.</p>
<p>The first and second derivatives of the smoother is calculated using
function <code><a href="https://gavinsimpson.github.io/gratia/reference/derivatives.html" class="external-link">gratia::derivatives()</a></code> with the following hard coded arguments:</p></li>
<li><p><code>type</code>: the type of finite difference used. Set  to <code>"central"</code>.</p></li>
<li><p><code>order</code>: 1 for the first derivative, 2 for the second derivative</p></li>
<li><p><code>level</code>: the confidence level. Set to 0.8</p></li>
<li><p><code>eps</code>: the finite difference. Set to 1e-4.</p>
<p>For more details, please check <a href="https://gavinsimpson.github.io/gratia/reference/derivatives.html" class="external-link">derivatives</a>.</p>
<p>The sign of the lower and upper confidence levels of the first and second
derivatives are used to define a detailed emergency status (<code>em</code>) which is
internally used to return the emergency status, <code>em_status</code>, which is a
column of the returned data.frame <code>em_summary</code>.</p><table class="table table"><tr><td>ucl-1</td><td>lcl-1</td><td>ucl-2</td><td>lcl-2</td><td>em</td><td>em_status</td></tr><tr><td>+</td><td>+</td><td>+</td><td>+</td><td>4</td><td>3 (emerging)</td></tr><tr><td>+</td><td>+</td><td>+</td><td>-</td><td>3</td><td>3 (emerging)</td></tr><tr><td>+</td><td>+</td><td>-</td><td>-</td><td>2</td><td>2 (potentially emerging)</td></tr><tr><td>-</td><td>+</td><td>+</td><td>+</td><td>1</td><td>2 (potentially emerging)</td></tr><tr><td>+</td><td>-</td><td>+</td><td>-</td><td>0</td><td>1 (unclear)</td></tr><tr><td>+</td><td>-</td><td>-</td><td>-</td><td>-1</td><td>0 (not emerging)</td></tr><tr><td>-</td><td>-</td><td>+</td><td>+</td><td>-2</td><td>0 (not emerging)</td></tr><tr><td>-</td><td>-</td><td>+</td><td>-</td><td>-3</td><td>0 (not emerging)</td></tr><tr><td>-</td><td>-</td><td>-</td><td>-</td><td>-4</td><td>0 (not emerging)</td></tr></table></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span><span class="va">df_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  taxonKey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3003709</span>, <span class="fl">24</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  canonicalName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Rosa glauca"</span>, <span class="fl">24</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="fl">2018</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">10</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">229</span>, <span class="fl">555</span>, <span class="fl">1116</span>, <span class="fl">939</span>, <span class="fl">919</span>, <span class="fl">853</span>, <span class="fl">442</span>, <span class="fl">532</span>, <span class="fl">623</span>, <span class="fl">1178</span>, <span class="fl">732</span>, <span class="fl">371</span>, <span class="fl">1053</span>,</span></span>
<span class="r-in"><span>    <span class="fl">1001</span>, <span class="fl">1550</span>, <span class="fl">1142</span>, <span class="fl">1076</span>, <span class="fl">1310</span>, <span class="fl">922</span>, <span class="fl">1773</span>, <span class="fl">1637</span>,</span></span>
<span class="r-in"><span>    <span class="fl">1866</span>, <span class="fl">2234</span>, <span class="fl">2013</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># apply GAM to n without baseline as covariate</span></span></span>
<span class="r-in"><span><span class="fu">apply_gam</span><span class="op">(</span><span class="va">df_gam</span>,</span></span>
<span class="r-in"><span>  y_var <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>  eval_years <span class="op">=</span> <span class="fl">2018</span>,</span></span>
<span class="r-in"><span>  taxon_key <span class="op">=</span> <span class="fl">3003709</span>,</span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">"Rosa glauca"</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Analyzing: Rosa glauca(3003709)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $em_summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   taxonKey  year em_status growth method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>018         3   1.02 basic </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: Negative Binomial(3.527) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n ~ s(year, k = maxk, m = 3, bs = "tp")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  total = 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 42.28844     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    taxonKey canonicalName  year     n n_class method   fit   ucl   lcl   em1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>995     1     229 basic  0.530  2.25 0.125     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>996     1     555 basic  0.570  1.97 0.165     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>997     0    <span style="text-decoration: underline;">1</span>116 basic  0.614  1.78 0.212     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>998     0     939 basic  0.664  1.65 0.268     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>999     0     919 basic  0.721  1.58 0.329     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>000     2     853 basic  0.786  1.57 0.394     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>001     0     442 basic  0.859  1.61 0.460     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>002     0     532 basic  0.943  1.70 0.524     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>003     1     623 basic  1.04   1.84 0.587     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>004     3    <span style="text-decoration: underline;">1</span>178 basic  1.15   2.02 0.651     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: em2 &lt;dbl&gt;, em &lt;dbl&gt;, em_status &lt;dbl&gt;, growth &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $first_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative     se  crit  lower_ci upper_ci  year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)     0.069<span style="text-decoration: underline;">9</span> 0.124   1.28 -<span style="color: #BB0000;">0.089</span><span style="color: #BB0000; text-decoration: underline;">1</span>      0.229 <span style="text-decoration: underline;">1</span>995.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)     0.073<span style="text-decoration: underline;">4</span> 0.115   1.28 -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">9</span>      0.221 <span style="text-decoration: underline;">1</span>996.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)     0.077<span style="text-decoration: underline;">0</span> 0.106   1.28 -<span style="color: #BB0000;">0.058</span><span style="color: #BB0000; text-decoration: underline;">8</span>      0.213 <span style="text-decoration: underline;">1</span>997.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)     0.080<span style="text-decoration: underline;">5</span> 0.097<span style="text-decoration: underline;">0</span>  1.28 -<span style="color: #BB0000;">0.043</span><span style="color: #BB0000; text-decoration: underline;">7</span>      0.205 <span style="text-decoration: underline;">1</span>998.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)     0.084<span style="text-decoration: underline;">1</span> 0.088<span style="text-decoration: underline;">1</span>  1.28 -<span style="color: #BB0000;">0.028</span><span style="color: #BB0000; text-decoration: underline;">8</span>      0.197 <span style="text-decoration: underline;">1</span>999.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)     0.087<span style="text-decoration: underline;">6</span> 0.079<span style="text-decoration: underline;">3</span>  1.28 -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">0</span>      0.189 <span style="text-decoration: underline;">2</span>000.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)     0.091<span style="text-decoration: underline;">1</span> 0.070<span style="text-decoration: underline;">7</span>  1.28  0.000<span style="text-decoration: underline;">581</span>    0.182 <span style="text-decoration: underline;">2</span>001.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)     0.094<span style="text-decoration: underline;">7</span> 0.062<span style="text-decoration: underline;">3</span>  1.28  0.014<span style="text-decoration: underline;">9</span>      0.174 <span style="text-decoration: underline;">2</span>002.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)     0.098<span style="text-decoration: underline;">2</span> 0.054<span style="text-decoration: underline;">2</span>  1.28  0.028<span style="text-decoration: underline;">8</span>      0.168 <span style="text-decoration: underline;">2</span>003.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)     0.102  0.046<span style="text-decoration: underline;">6</span>  1.28  0.042<span style="text-decoration: underline;">1</span>      0.161 <span style="text-decoration: underline;">2</span>004.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $second_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative      se  crit lower_ci upper_ci  year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">38</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>995.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">38</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>996.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>997.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>998.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>999.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>000.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>001.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>002.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>003.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>004.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $plot</span>
<span class="r-plt img"><img src="apply_gam-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># apply GAM using baseline data in column n_class as covariate</span></span></span>
<span class="r-in"><span><span class="fu">apply_gam</span><span class="op">(</span><span class="va">df_gam</span>,</span></span>
<span class="r-in"><span>  y_var <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>  eval_years <span class="op">=</span> <span class="fl">2018</span>,</span></span>
<span class="r-in"><span>  baseline_var <span class="op">=</span> <span class="st">"n_class"</span>,</span></span>
<span class="r-in"><span>  taxon_key <span class="op">=</span> <span class="fl">3003709</span>,</span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">"Rosa glauca"</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Analyzing: Rosa glauca(3003709)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $em_summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   taxonKey  year em_status growth method          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>018         1  0.980 correct_baseline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: Negative Binomial(2.907) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n ~ s(year, k = maxk, m = 3, bs = "tp") + s(n_class)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1  total = 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 42.23685     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    taxonKey canonicalName  year     n n_class method       fit   ucl   lcl   em1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>995     1     229 correct_b… 0.488  2.30 0.103     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>996     1     555 correct_b… 0.522  2.07 0.132     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>997     0    <span style="text-decoration: underline;">1</span>116 correct_b… 0.561  1.92 0.164     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>998     0     939 correct_b… 0.606  1.84 0.200     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>999     0     919 correct_b… 0.658  1.82 0.239     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>000     2     853 correct_b… 0.719  1.84 0.280     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>001     0     442 correct_b… 0.789  1.91 0.325     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>002     0     532 correct_b… 0.870  2.02 0.375     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>003     1     623 correct_b… 0.964  2.16 0.431     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>004     3    <span style="text-decoration: underline;">1</span>178 correct_b… 1.07   2.32 0.498     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: em2 &lt;dbl&gt;, em &lt;dbl&gt;, em_status &lt;dbl&gt;, growth &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $first_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 48 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative     se  crit lower_ci upper_ci  year n_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)     0.064<span style="text-decoration: underline;">7</span> 0.131   1.28 -<span style="color: #BB0000;">0.103</span>      0.232 <span style="text-decoration: underline;">1</span>995.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)     0.069<span style="text-decoration: underline;">8</span> 0.120   1.28 -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.224 <span style="text-decoration: underline;">1</span>996.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)     0.074<span style="text-decoration: underline;">9</span> 0.110   1.28 -<span style="color: #BB0000;">0.065</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.216 <span style="text-decoration: underline;">1</span>997.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)     0.080<span style="text-decoration: underline;">0</span> 0.099<span style="text-decoration: underline;">8</span>  1.28 -<span style="color: #BB0000;">0.047</span><span style="color: #BB0000; text-decoration: underline;">9</span>     0.208 <span style="text-decoration: underline;">1</span>998.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)     0.085<span style="text-decoration: underline;">1</span> 0.090<span style="text-decoration: underline;">2</span>  1.28 -<span style="color: #BB0000;">0.030</span><span style="color: #BB0000; text-decoration: underline;">5</span>     0.201 <span style="text-decoration: underline;">1</span>999.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)     0.090<span style="text-decoration: underline;">2</span> 0.081<span style="text-decoration: underline;">2</span>  1.28 -<span style="color: #BB0000;">0.013</span><span style="color: #BB0000; text-decoration: underline;">8</span>     0.194 <span style="text-decoration: underline;">2</span>000.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)     0.095<span style="text-decoration: underline;">3</span> 0.072<span style="text-decoration: underline;">8</span>  1.28  0.001<span style="text-decoration: underline;">98</span>    0.189 <span style="text-decoration: underline;">2</span>001.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)     0.100  0.065<span style="text-decoration: underline;">6</span>  1.28  0.016<span style="text-decoration: underline;">4</span>     0.184 <span style="text-decoration: underline;">2</span>002.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)     0.106  0.059<span style="text-decoration: underline;">7</span>  1.28  0.029<span style="text-decoration: underline;">1</span>     0.182 <span style="text-decoration: underline;">2</span>003.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)     0.111  0.055<span style="text-decoration: underline;">6</span>  1.28  0.039<span style="text-decoration: underline;">4</span>     0.182 <span style="text-decoration: underline;">2</span>004.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 38 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $second_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 48 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative     se  crit lower_ci upper_ci  year n_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>995.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>996.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>997.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>998.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>999.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>000.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>001.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>002.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>003.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>004.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 38 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $plot</span>
<span class="r-plt img"><img src="apply_gam-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># apply GAM using n as occupancy values, evaluate on two years. No baseline</span></span></span>
<span class="r-in"><span><span class="fu">apply_gam</span><span class="op">(</span><span class="va">df_gam</span>,</span></span>
<span class="r-in"><span>  y_var <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>  eval_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2017</span>, <span class="fl">2018</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  taxon_key <span class="op">=</span> <span class="fl">3003709</span>,</span></span>
<span class="r-in"><span>  type_indicator <span class="op">=</span> <span class="st">"occupancy"</span>,</span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">"Rosa glauca"</span>,</span></span>
<span class="r-in"><span>  y_label <span class="op">=</span> <span class="st">"occupancy"</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Analyzing: Rosa glauca(3003709)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $em_summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   taxonKey  year em_status growth method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>017         3   1.03 basic </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>018         3   1.02 basic </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: Negative Binomial(3.527) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n ~ s(year, k = maxk, m = 3, bs = "tp")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  total = 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 42.28844     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    taxonKey canonicalName  year     n n_class method   fit   ucl   lcl   em1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>995     1     229 basic  0.530  2.25 0.125     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>996     1     555 basic  0.570  1.97 0.165     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>997     0    <span style="text-decoration: underline;">1</span>116 basic  0.614  1.78 0.212     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>998     0     939 basic  0.664  1.65 0.268     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>999     0     919 basic  0.721  1.58 0.329     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>000     2     853 basic  0.786  1.57 0.394     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>001     0     442 basic  0.859  1.61 0.460     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>002     0     532 basic  0.943  1.70 0.524     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>003     1     623 basic  1.04   1.84 0.587     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>004     3    <span style="text-decoration: underline;">1</span>178 basic  1.15   2.02 0.651     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: em2 &lt;dbl&gt;, em &lt;dbl&gt;, em_status &lt;dbl&gt;, growth &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $first_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative     se  crit  lower_ci upper_ci  year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)     0.069<span style="text-decoration: underline;">9</span> 0.124   1.28 -<span style="color: #BB0000;">0.089</span><span style="color: #BB0000; text-decoration: underline;">1</span>      0.229 <span style="text-decoration: underline;">1</span>995.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)     0.073<span style="text-decoration: underline;">4</span> 0.115   1.28 -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">9</span>      0.221 <span style="text-decoration: underline;">1</span>996.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)     0.077<span style="text-decoration: underline;">0</span> 0.106   1.28 -<span style="color: #BB0000;">0.058</span><span style="color: #BB0000; text-decoration: underline;">8</span>      0.213 <span style="text-decoration: underline;">1</span>997.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)     0.080<span style="text-decoration: underline;">5</span> 0.097<span style="text-decoration: underline;">0</span>  1.28 -<span style="color: #BB0000;">0.043</span><span style="color: #BB0000; text-decoration: underline;">7</span>      0.205 <span style="text-decoration: underline;">1</span>998.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)     0.084<span style="text-decoration: underline;">1</span> 0.088<span style="text-decoration: underline;">1</span>  1.28 -<span style="color: #BB0000;">0.028</span><span style="color: #BB0000; text-decoration: underline;">8</span>      0.197 <span style="text-decoration: underline;">1</span>999.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)     0.087<span style="text-decoration: underline;">6</span> 0.079<span style="text-decoration: underline;">3</span>  1.28 -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">0</span>      0.189 <span style="text-decoration: underline;">2</span>000.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)     0.091<span style="text-decoration: underline;">1</span> 0.070<span style="text-decoration: underline;">7</span>  1.28  0.000<span style="text-decoration: underline;">581</span>    0.182 <span style="text-decoration: underline;">2</span>001.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)     0.094<span style="text-decoration: underline;">7</span> 0.062<span style="text-decoration: underline;">3</span>  1.28  0.014<span style="text-decoration: underline;">9</span>      0.174 <span style="text-decoration: underline;">2</span>002.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)     0.098<span style="text-decoration: underline;">2</span> 0.054<span style="text-decoration: underline;">2</span>  1.28  0.028<span style="text-decoration: underline;">8</span>      0.168 <span style="text-decoration: underline;">2</span>003.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)     0.102  0.046<span style="text-decoration: underline;">6</span>  1.28  0.042<span style="text-decoration: underline;">1</span>      0.161 <span style="text-decoration: underline;">2</span>004.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $second_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative      se  crit lower_ci upper_ci  year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">38</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>995.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">38</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>996.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>997.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>998.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>999.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>000.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>001.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>002.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>003.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>004.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $plot</span>
<span class="r-plt img"><img src="apply_gam-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># apply GAM using n as occupancy values and n_class as covariate (baseline)</span></span></span>
<span class="r-in"><span><span class="fu">apply_gam</span><span class="op">(</span><span class="va">df_gam</span>,</span></span>
<span class="r-in"><span>  y_var <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>  eval_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2017</span>, <span class="fl">2018</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  baseline_var <span class="op">=</span> <span class="st">"n_class"</span>,</span></span>
<span class="r-in"><span>  taxon_key <span class="op">=</span> <span class="fl">3003709</span>,</span></span>
<span class="r-in"><span>  type_indicator <span class="op">=</span> <span class="st">"occupancy"</span>,</span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">"Rosa glauca"</span>,</span></span>
<span class="r-in"><span>  y_label <span class="op">=</span> <span class="st">"occupancy"</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Analyzing: Rosa glauca(3003709)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $em_summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   taxonKey  year em_status growth method          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>017         1  0.989 correct_baseline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>018         1  0.980 correct_baseline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: Negative Binomial(2.907) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n ~ s(year, k = maxk, m = 3, bs = "tp") + s(n_class)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1  total = 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 42.23685     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    taxonKey canonicalName  year     n n_class method       fit   ucl   lcl   em1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>995     1     229 correct_b… 0.488  2.30 0.103     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>996     1     555 correct_b… 0.522  2.07 0.132     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>997     0    <span style="text-decoration: underline;">1</span>116 correct_b… 0.561  1.92 0.164     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>998     0     939 correct_b… 0.606  1.84 0.200     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>999     0     919 correct_b… 0.658  1.82 0.239     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>000     2     853 correct_b… 0.719  1.84 0.280     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>001     0     442 correct_b… 0.789  1.91 0.325     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>002     0     532 correct_b… 0.870  2.02 0.375     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>003     1     623 correct_b… 0.964  2.16 0.431     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>004     3    <span style="text-decoration: underline;">1</span>178 correct_b… 1.07   2.32 0.498     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: em2 &lt;dbl&gt;, em &lt;dbl&gt;, em_status &lt;dbl&gt;, growth &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $first_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 48 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative     se  crit lower_ci upper_ci  year n_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)     0.064<span style="text-decoration: underline;">7</span> 0.131   1.28 -<span style="color: #BB0000;">0.103</span>      0.232 <span style="text-decoration: underline;">1</span>995.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)     0.069<span style="text-decoration: underline;">8</span> 0.120   1.28 -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.224 <span style="text-decoration: underline;">1</span>996.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)     0.074<span style="text-decoration: underline;">9</span> 0.110   1.28 -<span style="color: #BB0000;">0.065</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.216 <span style="text-decoration: underline;">1</span>997.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)     0.080<span style="text-decoration: underline;">0</span> 0.099<span style="text-decoration: underline;">8</span>  1.28 -<span style="color: #BB0000;">0.047</span><span style="color: #BB0000; text-decoration: underline;">9</span>     0.208 <span style="text-decoration: underline;">1</span>998.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)     0.085<span style="text-decoration: underline;">1</span> 0.090<span style="text-decoration: underline;">2</span>  1.28 -<span style="color: #BB0000;">0.030</span><span style="color: #BB0000; text-decoration: underline;">5</span>     0.201 <span style="text-decoration: underline;">1</span>999.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)     0.090<span style="text-decoration: underline;">2</span> 0.081<span style="text-decoration: underline;">2</span>  1.28 -<span style="color: #BB0000;">0.013</span><span style="color: #BB0000; text-decoration: underline;">8</span>     0.194 <span style="text-decoration: underline;">2</span>000.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)     0.095<span style="text-decoration: underline;">3</span> 0.072<span style="text-decoration: underline;">8</span>  1.28  0.001<span style="text-decoration: underline;">98</span>    0.189 <span style="text-decoration: underline;">2</span>001.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)     0.100  0.065<span style="text-decoration: underline;">6</span>  1.28  0.016<span style="text-decoration: underline;">4</span>     0.184 <span style="text-decoration: underline;">2</span>002.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)     0.106  0.059<span style="text-decoration: underline;">7</span>  1.28  0.029<span style="text-decoration: underline;">1</span>     0.182 <span style="text-decoration: underline;">2</span>003.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)     0.111  0.055<span style="text-decoration: underline;">6</span>  1.28  0.039<span style="text-decoration: underline;">4</span>     0.182 <span style="text-decoration: underline;">2</span>004.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 38 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $second_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 48 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative     se  crit lower_ci upper_ci  year n_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>995.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>996.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>997.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>998.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>999.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>000.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>001.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>002.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>003.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>004.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 38 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $plot</span>
<span class="r-plt img"><img src="apply_gam-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># How to use other arguments</span></span></span>
<span class="r-in"><span><span class="fu">apply_gam</span><span class="op">(</span><span class="va">df_gam</span>,</span></span>
<span class="r-in"><span>  y_var <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>  eval_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2017</span>, <span class="fl">2018</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  baseline_var <span class="op">=</span> <span class="st">"n_class"</span>,</span></span>
<span class="r-in"><span>  p_max <span class="op">=</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>  taxon_key <span class="op">=</span> <span class="st">"3003709"</span>,</span></span>
<span class="r-in"><span>  type_indicator <span class="op">=</span> <span class="st">"occupancy"</span>,</span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">"Rosa glauca"</span>,</span></span>
<span class="r-in"><span>  df_title <span class="op">=</span> <span class="st">"Belgium"</span>,</span></span>
<span class="r-in"><span>  x_label <span class="op">=</span> <span class="st">"time (years)"</span>,</span></span>
<span class="r-in"><span>  y_label <span class="op">=</span> <span class="st">"area of occupancy (km2)"</span>,</span></span>
<span class="r-in"><span>  saveplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  dir_name <span class="op">=</span> <span class="st">"./data/"</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> width not provided. Set to 1680 pixels.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> height not provided. Set to 1200 pixels.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Analyzing: Rosa glauca(3003709)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Output plot: ./data/GAM_occupancy_correct_baseline_3003709_Rosa glauca_Belgium.png"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $em_summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   taxonKey  year em_status growth method          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>017         1  0.989 correct_baseline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>018         1  0.980 correct_baseline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: Negative Binomial(2.907) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link function: log </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n ~ s(year, k = maxk, m = 3, bs = "tp") + s(n_class)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated degrees of freedom:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1  total = 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REML score: 42.23685     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 24 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    taxonKey canonicalName  year     n n_class method       fit   ucl   lcl   em1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>995     1     229 correct_b… 0.488  2.30 0.103     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>996     1     555 correct_b… 0.522  2.07 0.132     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>997     0    <span style="text-decoration: underline;">1</span>116 correct_b… 0.561  1.92 0.164     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>998     0     939 correct_b… 0.606  1.84 0.200     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>999     0     919 correct_b… 0.658  1.82 0.239     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>000     2     853 correct_b… 0.719  1.84 0.280     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>001     0     442 correct_b… 0.789  1.91 0.325     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>002     0     532 correct_b… 0.870  2.02 0.375     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>003     1     623 correct_b… 0.964  2.16 0.431     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>004     3    <span style="text-decoration: underline;">1</span>178 correct_b… 1.07   2.32 0.498     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: em2 &lt;dbl&gt;, em &lt;dbl&gt;, em_status &lt;dbl&gt;, growth &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $first_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 48 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative     se  crit lower_ci upper_ci  year n_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)     0.064<span style="text-decoration: underline;">7</span> 0.131   1.28 -<span style="color: #BB0000;">0.103</span>      0.232 <span style="text-decoration: underline;">1</span>995.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)     0.069<span style="text-decoration: underline;">8</span> 0.120   1.28 -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">0</span>     0.224 <span style="text-decoration: underline;">1</span>996.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)     0.074<span style="text-decoration: underline;">9</span> 0.110   1.28 -<span style="color: #BB0000;">0.065</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.216 <span style="text-decoration: underline;">1</span>997.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)     0.080<span style="text-decoration: underline;">0</span> 0.099<span style="text-decoration: underline;">8</span>  1.28 -<span style="color: #BB0000;">0.047</span><span style="color: #BB0000; text-decoration: underline;">9</span>     0.208 <span style="text-decoration: underline;">1</span>998.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)     0.085<span style="text-decoration: underline;">1</span> 0.090<span style="text-decoration: underline;">2</span>  1.28 -<span style="color: #BB0000;">0.030</span><span style="color: #BB0000; text-decoration: underline;">5</span>     0.201 <span style="text-decoration: underline;">1</span>999.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)     0.090<span style="text-decoration: underline;">2</span> 0.081<span style="text-decoration: underline;">2</span>  1.28 -<span style="color: #BB0000;">0.013</span><span style="color: #BB0000; text-decoration: underline;">8</span>     0.194 <span style="text-decoration: underline;">2</span>000.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)     0.095<span style="text-decoration: underline;">3</span> 0.072<span style="text-decoration: underline;">8</span>  1.28  0.001<span style="text-decoration: underline;">98</span>    0.189 <span style="text-decoration: underline;">2</span>001.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)     0.100  0.065<span style="text-decoration: underline;">6</span>  1.28  0.016<span style="text-decoration: underline;">4</span>     0.184 <span style="text-decoration: underline;">2</span>002.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)     0.106  0.059<span style="text-decoration: underline;">7</span>  1.28  0.029<span style="text-decoration: underline;">1</span>     0.182 <span style="text-decoration: underline;">2</span>003.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)     0.111  0.055<span style="text-decoration: underline;">6</span>  1.28  0.039<span style="text-decoration: underline;">4</span>     0.182 <span style="text-decoration: underline;">2</span>004.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 38 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $second_derivative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 48 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    smooth  derivative     se  crit lower_ci upper_ci  year n_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>995.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>996.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>997.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>998.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">1</span>999.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>000.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>001.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>002.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>003.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> s(year)    0.005<span style="text-decoration: underline;">11</span> 0.011<span style="text-decoration: underline;">6</span>  1.28 -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">79</span>   0.020<span style="text-decoration: underline;">0</span> <span style="text-decoration: underline;">2</span>004.      <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 38 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $plot</span>
<span class="r-plt img"><img src="apply_gam-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># warning returned if GAM cannot be applied and plot with only observations</span></span></span>
<span class="r-in"><span><span class="va">df_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>taxonKey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3003709</span>, <span class="fl">24</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>canonicalName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Rosa glauca"</span>, <span class="fl">24</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="fl">2018</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span>,</span></span>
<span class="r-in"><span>cobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if GAM cannot be applied a warning is returned and the plot mention it</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">no_gam_applied</span> <span class="op">&lt;-</span> <span class="fu">apply_gam</span><span class="op">(</span><span class="va">df_gam</span>,</span></span>
<span class="r-in"><span>                            y_var <span class="op">=</span> <span class="st">"obs"</span>,</span></span>
<span class="r-in"><span>                            eval_years <span class="op">=</span> <span class="fl">2018</span>,</span></span>
<span class="r-in"><span>                            taxon_key <span class="op">=</span> <span class="fl">3003709</span>,</span></span>
<span class="r-in"><span>                            name <span class="op">=</span> <span class="st">"Rosa glauca"</span>,</span></span>
<span class="r-in"><span>                            baseline_var <span class="op">=</span> <span class="st">"cobs"</span>,</span></span>
<span class="r-in"><span>                            verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">no_gam_applied</span><span class="op">$</span><span class="va">plot</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://twitter.com/damianozingaro" class="external-link">Damiano Oldoni</a>, Soria Delva, Sander Devisscher, Machteld Varewyck, Research Institute for Nature and Forest (INBO), <a href="https://trias-project.be" class="external-link"><img src="https://osf.io/dqvfk/?action=download" width="72"></a>, <a href="https://www.riparias.be" class="external-link"><img src="https://www.riparias.be/static/images/bbpf.png" width="72"></a>, European Union’s Horizon Europe Research and Innovation Programme (ID No 101059592).</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

