<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spread key-value pairs across multiple columns. — spread_with_multiple_values • trias</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Spread key-value pairs across multiple columns. — spread_with_multiple_values" />

<meta property="og:description" content="This function spread one or more key-value pairs across multiple
  columns. If only one value exists per key, then this functions returns the
  same output as spread. Otherwise, aggregation function
  aggfunc is applied. If no function is passed, then the key-value(s)
  are spread on multiple rows." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trias</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/trias-project/trias">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spread key-value pairs across multiple columns.</h1>
    <small class="dont-index">Source: <a href='https://github.com/trias-project/trias/blob/master/R/spread_with_multiple_values.R'><code>R/spread_with_multiple_values.R</code></a></small>
    <div class="hidden name"><code>spread_with_multiple_values.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function spread one or more key-value pairs across multiple
  columns. If only one value exists per key, then this functions returns the
  same output as <code><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></code>. Otherwise, aggregation function
  <code>aggfunc</code> is applied. If no function is passed, then the key-value(s)
  are spread on multiple rows.</p>
    
    </div>

    <pre class="usage"><span class='fu'>spread_with_multiple_values</span>(<span class='no'>data</span>, <span class='no'>key</span>, <span class='no'>value</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>convert</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>drop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>aggfunc</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A dataframe.</p></td>
    </tr>
    <tr>
      <th>key, value</th>
      <td><p>Column names or positions. This is passed to
<code><a href='https://rdrr.io/pkg/tidyselect/man/vars_pull.html'>vars_pull</a></code>. These arguments are passed by
expression and support <code><a href='https://rlang.r-lib.org/reference/quasiquotation.html'>quasiquotation</a></code> (you can unquote
column names or column positions).</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>If set, missing values will be replaced with this value.</p></td>
    </tr>
    <tr>
      <th>convert</th>
      <td><p>If <code>TRUE</code>, <code><a href='https://rdrr.io/r/utils/type.convert.html'>type.convert</a></code> with
<code>asis = TRUE</code> will be run on each of the new columns. This is useful
if the value column was a mix of variables that was coerced to a string. If
the class of the value column was factor or date, note that will not be
true of the new columns that are produced, which are coerced to character
before type conversion.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>If <code>FALSE</code>, will keep factor levels that don't appear in the
data, filling in missing combinations with <code>fill</code>.</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>If <code>NULL</code>, the column names will be taken from the values of
<code>key</code> variable. If non-<code>NULL</code>, the column names will be given by
"&lt;key_name&gt;&lt;sep&gt;&lt;key_value&gt;".</p></td>
    </tr>
    <tr>
      <th>aggfunc</th>
      <td><p>Aggregation function. Default: NULL (keep all values on
different rows).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any parameter needed to apply <code>aggfunc</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='no'>test1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
<span class='kw'>col1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>),
<span class='kw'>col2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"H"</span>, <span class='st'>"H"</span>, <span class='st'>"H"</span>, <span class='st'>"H"</span>),
<span class='kw'>key</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>, <span class='st'>"C"</span>),
<span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"R"</span>, <span class='st'>"S"</span>, <span class='st'>"T"</span>, <span class='st'>"X"</span>),
<span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test1</span>, <span class='no'>key</span>, <span class='no'>value</span>)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test1</span>, <span class='fl'>3</span>, <span class='fl'>4</span>)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test1</span>, -<span class='fl'>2</span>, -<span class='fl'>1</span>)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test1</span>, <span class='st'>"key"</span>, <span class='st'>"value"</span>)

<span class='co'># with NAs</span>
<span class='no'>test2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
<span class='kw'>col1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>2</span>),
<span class='kw'>key</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"A"</span>, <span class='st'>"C"</span>, <span class='st'>"C"</span>, <span class='st'>"A"</span>),
<span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"R"</span>, <span class='st'>"T"</span>, <span class='st'>"X"</span>, <span class='st'>"R"</span>),
<span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test2</span>, <span class='no'>key</span>, <span class='no'>value</span>)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test2</span>, <span class='no'>key</span>, <span class='no'>value</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='st'>"No idea"</span>)

<span class='co'># apply aggregate function</span>
<span class='no'>test3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
<span class='kw'>col1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>),
  <span class='kw'>col2</span>  <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"H"</span>, <span class='st'>"H"</span>, <span class='st'>"H"</span>, <span class='st'>"H"</span>),
  <span class='kw'>key</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>, <span class='st'>"C"</span>),
  <span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>8</span>),
  <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test1</span>, <span class='no'>key</span>, <span class='no'>value</span>, <span class='kw'>aggfunc</span> <span class='kw'>=</span> <span class='no'>str_c</span>, <span class='kw'>collapse</span> <span class='kw'>=</span> <span class='st'>"-"</span>)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test3</span>, <span class='no'>key</span>, <span class='no'>value</span>, <span class='kw'>aggfunc</span> <span class='kw'>=</span> <span class='no'>min</span>)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test3</span>, <span class='no'>key</span>, <span class='no'>value</span>, <span class='kw'>aggfunc</span> <span class='kw'>=</span> <span class='no'>mean</span>)

<span class='co'># same output of tidyr::spread() if one value per key and no aggfunc</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='no'>stocks</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
 <span class='kw'>time</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span>(<span class='st'>'2009-01-01'</span>) + <span class='fl'>0</span>:<span class='fl'>9</span>,
 <span class='kw'>X</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>10</span>, <span class='fl'>0</span>, <span class='fl'>1</span>),
 <span class='kw'>Y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>10</span>, <span class='fl'>0</span>, <span class='fl'>2</span>),
 <span class='kw'>Z</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>10</span>, <span class='fl'>0</span>, <span class='fl'>4</span>)
)
<span class='no'>stocksm</span> <span class='kw'>&lt;-</span> <span class='no'>stocks</span> <span class='kw'>%&gt;%</span> <span class='fu'>gather</span>(<span class='no'>stock</span>, <span class='no'>price</span>, -<span class='no'>time</span>)
<span class='no'>stocksm</span> <span class='kw'>%&gt;%</span> <span class='fu'>spread_with_multiple_values</span>(<span class='no'>stock</span>, <span class='no'>price</span>)
<span class='no'>stocksm</span> <span class='kw'>%&gt;%</span> <span class='kw pkg'>tidyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></span>(<span class='no'>stock</span>, <span class='no'>price</span>)
<span class='no'>stocksm</span> <span class='kw'>%&gt;%</span> <span class='fu'>spread_with_multiple_values</span>(<span class='no'>time</span>, <span class='no'>price</span>)
<span class='no'>stocksm</span> <span class='kw'>%&gt;%</span> <span class='kw pkg'>tidyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></span>(<span class='no'>time</span>, <span class='no'>price</span>)

<span class='co'># Use 'convert = TRUE' to produce variables of mixed type</span>
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>row</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>51</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>3</span>),
                 <span class='kw'>var</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Sepal.Length"</span>, <span class='st'>"Species"</span>, <span class='st'>"Species_num"</span>),
                 <span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5.1</span>, <span class='st'>"setosa"</span>, <span class='fl'>1</span>, <span class='fl'>7.0</span>, <span class='st'>"versicolor"</span>, <span class='fl'>2</span>))
<span class='no'>df</span> <span class='kw'>%&gt;%</span> <span class='fu'>spread_with_multiple_values</span>(<span class='no'>var</span>, <span class='no'>value</span>) <span class='kw'>%&gt;%</span> <span class='no'>str</span>
<span class='no'>df</span> <span class='kw'>%&gt;%</span> <span class='kw pkg'>tidyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></span>(<span class='no'>var</span>, <span class='no'>value</span>, <span class='kw'>convert</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='kw'>%&gt;%</span> <span class='no'>str</span>

<span class='co'># Use sep non-NULL</span>
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>test2</span>, <span class='no'>key</span>, <span class='no'>value</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>"_var_"</span>)
<span class='fu'>spread_with_multiple_values</span>(<span class='no'>df</span>, <span class='no'>var</span>, <span class='no'>value</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>"_"</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://twitter.com/damianozingaro'>Damiano Oldoni</a>, <a href='https://twitter.com/peterdesmet'>Peter Desmet</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


