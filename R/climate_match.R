climate_match <- function(region, 
                          species, 
                          scenario = "all",
                          n_totaal,
                          perc_climate,
                          coord_unc, 
                          BasisOfRecord){
  
  # Setup ####
  library(rgbif)
  library(sp)
  library(rgdal)
  library(raster)
  library(rworldmap)
  library(tidyverse)
  
  # Checks ####
  # Download data ####
  # Climate matching occurence data ####
  # Determine future scenarios ####
  # Per scenario filter ####
  # Thresholds ####
  # Return ####
  
}