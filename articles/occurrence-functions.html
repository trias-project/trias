<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Occurrence functions • trias</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Occurrence functions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/checklist-functions.html">Checklist functions</a></li>
    <li><a class="dropdown-item" href="../articles/occurrence-functions.html">Occurrence functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/trias-project/trias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Occurrence functions</h1>
                        <h4 data-toc-skip class="author">Damiano
Oldoni</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/trias-project/trias/blob/main/vignettes/occurrence-functions.Rmd" class="external-link"><code>vignettes/occurrence-functions.Rmd</code></a></small>
      <div class="d-none name"><code>occurrence-functions.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates the occurrence-based functions in the
trias package for assessing emerging status of alien species using time
series data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trias-project/trias" class="external-link">trias</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The occurrence functions analyze time series of observations or
occupancy data to detect emerging alien species. Two approaches are
available:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Decision rules</strong> - Apply simple logical rules to
assess emerging status</li>
<li>
<strong>GAM (Generalized Additive Models)</strong> - Use statistical
models to detect significant trends</li>
</ol>
</div>
<div class="section level2">
<h2 id="decision-rules-approach">Decision rules approach<a class="anchor" aria-label="anchor" href="#decision-rules-approach"></a>
</h2>
<p>The <code><a href="../reference/apply_decision_rules.html">apply_decision_rules()</a></code> function applies a set of
decision rules to time series data to assess emerging status at a
specific evaluation year.</p>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>Let’s create example time series data for two taxa:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_rules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  taxonID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1008955</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2493598</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2009</span>, <span class="fl">2018</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2016</span>, <span class="fl">2018</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the data</span></span>
<span><span class="va">df_rules</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 3</span></span></span>
<span><span class="co">#&gt;    taxonID  year   obs</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>009     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>010     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>011     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>012     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>013     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>014     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>015     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>016     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>017     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>018     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2<span style="text-decoration: underline;">493</span>598  <span style="text-decoration: underline;">2</span>016     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 2<span style="text-decoration: underline;">493</span>598  <span style="text-decoration: underline;">2</span>017     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2<span style="text-decoration: underline;">493</span>598  <span style="text-decoration: underline;">2</span>018     0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="apply-decision-rules">Apply decision rules<a class="anchor" aria-label="anchor" href="#apply-decision-rules"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply decision rules to assess emerging status in 2016</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_decision_rules.html">apply_decision_rules</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">df_rules</span>,</span>
<span>  eval_year <span class="op">=</span> <span class="fl">2016</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"obs"</span>,</span>
<span>  taxonKey <span class="op">=</span> <span class="st">"taxonID"</span>,</span>
<span>  year <span class="op">=</span> <span class="st">"year"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the results</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;   taxonID  year em_status dr_1  dr_2  dr_3  dr_4 </span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1<span style="text-decoration: underline;">008</span>955  <span style="text-decoration: underline;">2</span>016         1 FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2<span style="text-decoration: underline;">493</span>598  <span style="text-decoration: underline;">2</span>016         1 TRUE  FALSE FALSE TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="understanding-the-results">Understanding the results<a class="anchor" aria-label="anchor" href="#understanding-the-results"></a>
</h3>
<p>The function returns:</p>
<ul>
<li>
<strong>em_status</strong>: Emerging status (0-3)
<ul>
<li>0: Not emerging</li>
<li>1: Unclear</li>
<li>2: Potentially emerging</li>
<li>3: Emerging</li>
</ul>
</li>
<li>
<strong>dr_1</strong>: Does the time series contain only one
positive value at evaluation year?</li>
<li>
<strong>dr_2</strong>: Is value at evaluation year above median
value?</li>
<li>
<strong>dr_3</strong>: Does the time series contain only zeros in
the five years before evaluation year?</li>
<li>
<strong>dr_4</strong>: Is the value at evaluation year the maximum
ever observed?</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="gam-approach">GAM approach<a class="anchor" aria-label="anchor" href="#gam-approach"></a>
</h2>
<p>The <code><a href="../reference/apply_gam.html">apply_gam()</a></code> function uses Generalized Additive
Models to assess the emerging status of a species over a time window.
This is a more sophisticated statistical approach that can detect trends
and account for research effort bias. It can also be applied on the
number of observations or occupancy data (number of occupied grid
cells), if given.</p>
<div class="section level3">
<h3 id="example-data-1">Example data<a class="anchor" aria-label="anchor" href="#example-data-1"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  taxonKey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3003709</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>  canonicalName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Rosa glauca"</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>  year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="fl">2018</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>,</span>
<span>    <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">10</span></span>
<span>  <span class="op">)</span>,</span>
<span>  n_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>,</span>
<span>    <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_gam</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 5</span></span></span>
<span><span class="co">#&gt;    taxonKey canonicalName  year     n n_class</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>995     1       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>996     1       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>997     0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>998     0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>999     0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>000     2       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>001     0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>002     0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>003     1       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>004     3       3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="apply-gam">Apply GAM<a class="anchor" aria-label="anchor" href="#apply-gam"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply GAM to assess emerging status</span></span>
<span><span class="va">result_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_gam.html">apply_gam</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">df_gam</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  eval_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2017</span>, <span class="fl">2018</span><span class="op">)</span>,</span>
<span>  year <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  taxonKey <span class="op">=</span> <span class="st">"taxonKey"</span>,</span>
<span>  type_indicator <span class="op">=</span> <span class="st">"observations"</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Rosa glauca"</span>,</span>
<span>  p_max <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  saveplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="va">result_gam</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="occurrence-functions_files/figure-html/apply-gam-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level3">
<h3 id="understanding-gam-results">Understanding GAM results<a class="anchor" aria-label="anchor" href="#understanding-gam-results"></a>
</h3>
<p>The <code><a href="../reference/apply_gam.html">apply_gam()</a></code> function returns a list with:</p>
<ul>
<li>
<strong>em_summary</strong>: Data frame summarizing emerging status
for each evaluation year</li>
<li>
<strong>output</strong>: Detailed GAM model output with predictions
and confidence intervals</li>
<li>
<strong>plot</strong>: Visualization showing:
<ul>
<li>Observed values (points)</li>
<li>GAM model fit (line)</li>
<li>Confidence intervals (shaded area)</li>
<li>Emerging status indicators</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_gam</span><span class="op">$</span><span class="va">em_summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   taxonKey  year em_status growth method</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>017         3   1.03 basic </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  3<span style="text-decoration: underline;">003</span>709  <span style="text-decoration: underline;">2</span>018         3   1.02 basic</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_gam</span><span class="op">$</span><span class="va">output</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 14</span></span></span>
<span><span class="co">#&gt;    taxonKey canonicalName  year     n n_class method   fit   ucl   lcl   em1</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>995     1       1 basic  0.530  2.25 0.125     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>996     1       1 basic  0.570  1.97 0.165     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>997     0       0 basic  0.614  1.78 0.212     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>998     0       0 basic  0.664  1.65 0.268     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">1</span>999     0       0 basic  0.721  1.58 0.329     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>000     2       2 basic  0.786  1.57 0.394     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>001     0       0 basic  0.859  1.61 0.460     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>002     0       0 basic  0.943  1.70 0.524     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>003     1       1 basic  1.04   1.84 0.587     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  3<span style="text-decoration: underline;">003</span>709 Rosa glauca    <span style="text-decoration: underline;">2</span>004     3       3 basic  1.15   2.02 0.651     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: em2 &lt;dbl&gt;, em &lt;dbl&gt;, em_status &lt;dbl&gt;, growth &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Other components include: - <strong>model</strong>: The formula
behind the GAM modelling</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_gam</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: Negative Binomial(3.527) </span></span>
<span><span class="co">#&gt; Link function: log </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; n ~ s(year, k = maxk, m = 3, bs = "tp")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span><span class="co">#&gt; 2  total = 3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML score: 42.28844</span></span></code></pre></div>
<ul>
<li>
<strong>first_derivative</strong> and
<strong>second_derivative</strong>: Data frames with derivatives of the
GAM fit, with confidence intervals.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_gam</span><span class="op">$</span><span class="va">first_derivative</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 7</span></span></span>
<span><span class="co">#&gt;    smooth  derivative     se  crit  lower_ci upper_ci  year</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> s(year)     0.069<span style="text-decoration: underline;">9</span> 0.124   1.28 -<span style="color: #BB0000;">0.089</span><span style="color: #BB0000; text-decoration: underline;">1</span>      0.229 <span style="text-decoration: underline;">1</span>995.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> s(year)     0.073<span style="text-decoration: underline;">4</span> 0.115   1.28 -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">9</span>      0.221 <span style="text-decoration: underline;">1</span>996.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> s(year)     0.077<span style="text-decoration: underline;">0</span> 0.106   1.28 -<span style="color: #BB0000;">0.058</span><span style="color: #BB0000; text-decoration: underline;">8</span>      0.213 <span style="text-decoration: underline;">1</span>997.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> s(year)     0.080<span style="text-decoration: underline;">5</span> 0.097<span style="text-decoration: underline;">0</span>  1.28 -<span style="color: #BB0000;">0.043</span><span style="color: #BB0000; text-decoration: underline;">7</span>      0.205 <span style="text-decoration: underline;">1</span>998.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> s(year)     0.084<span style="text-decoration: underline;">1</span> 0.088<span style="text-decoration: underline;">1</span>  1.28 -<span style="color: #BB0000;">0.028</span><span style="color: #BB0000; text-decoration: underline;">8</span>      0.197 <span style="text-decoration: underline;">1</span>999.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> s(year)     0.087<span style="text-decoration: underline;">6</span> 0.079<span style="text-decoration: underline;">3</span>  1.28 -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">0</span>      0.189 <span style="text-decoration: underline;">2</span>000.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> s(year)     0.091<span style="text-decoration: underline;">1</span> 0.070<span style="text-decoration: underline;">7</span>  1.28  0.000<span style="text-decoration: underline;">581</span>    0.182 <span style="text-decoration: underline;">2</span>001.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> s(year)     0.094<span style="text-decoration: underline;">7</span> 0.062<span style="text-decoration: underline;">3</span>  1.28  0.014<span style="text-decoration: underline;">9</span>      0.174 <span style="text-decoration: underline;">2</span>002.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> s(year)     0.098<span style="text-decoration: underline;">2</span> 0.054<span style="text-decoration: underline;">2</span>  1.28  0.028<span style="text-decoration: underline;">8</span>      0.168 <span style="text-decoration: underline;">2</span>003.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> s(year)     0.102  0.046<span style="text-decoration: underline;">6</span>  1.28  0.042<span style="text-decoration: underline;">1</span>      0.161 <span style="text-decoration: underline;">2</span>004.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_gam</span><span class="op">$</span><span class="va">second_derivative</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 24 × 7</span></span></span>
<span><span class="co">#&gt;    smooth  derivative      se  crit lower_ci upper_ci  year</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">38</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>995.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">38</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>996.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>997.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>998.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">1</span>999.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>000.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>001.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>002.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>003.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> s(year)    0.003<span style="text-decoration: underline;">54</span> 0.009<span style="text-decoration: underline;">37</span>  1.28 -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">47</span>   0.015<span style="text-decoration: underline;">6</span> <span style="text-decoration: underline;">2</span>004.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="correcting-for-research-effort">Correcting for research effort<a class="anchor" aria-label="anchor" href="#correcting-for-research-effort"></a>
</h3>
<p>The GAM approach can also correct for research effort bias using a
baseline covariate:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply GAM with baseline correction</span></span>
<span><span class="va">result_gam_corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_gam.html">apply_gam</a></span><span class="op">(</span><span class="va">df_gam</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  eval_years <span class="op">=</span> <span class="fl">2018</span>,</span>
<span>  baseline_var <span class="op">=</span> <span class="st">"n_class"</span>,</span>
<span>  taxon_key <span class="op">=</span> <span class="fl">3003709</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"Rosa glauca"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Analyzing: Rosa glauca(3003709)"</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="va">result_gam_corrected</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="occurrence-functions_files/figure-html/gam-baseline-1.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="choosing-between-approaches">Choosing between approaches<a class="anchor" aria-label="anchor" href="#choosing-between-approaches"></a>
</h2>
<p><strong>Use GAM when:</strong> - You have sufficient data (at least
10-15 time points) - You want to account for trends and variability -
You need to correct for research effort bias - You want statistical
confidence measures</p>
<p><strong>Use decision rules when:</strong> - You have limited data
(and GAM doesn’t work) - You want quick assessments</p>
</div>
<div class="section level2">
<h2 id="additional-resources">Additional resources<a class="anchor" aria-label="anchor" href="#additional-resources"></a>
</h2>
<p>For more information on individual functions, see the <a href="https://trias-project.github.io/trias/reference/index.html#occurrence-based-functions">Reference</a>
page.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Damiano Oldoni, Soria Delva, Sander Devisscher, Machteld Varewyck, Research Institute for Nature and Forest (INBO), <a href="https://trias-project.be" class="external-link"><img src="https://osf.io/dqvfk/?action=download" width="72"></a>, <a href="https://www.riparias.be" class="external-link"><img src="https://www.riparias.be/static/images/bbpf.png" width="72"></a>, European Union.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
